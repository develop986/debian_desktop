## Dockerfileでデスクトップ環境のコンテナを作る

[DockerでDebian 11(Bullseye)のLXDEデスクトップ環境にリモートデスクトップで接続できるコンテナを作成する](http://serverarekore.blogspot.com/2022/02/dockerdebian-11bullseyelxde.html)

> 先に[Dockerfile](Dockerfile)のkuhara欄を、変更したいユーザー名とパスワードに変更する

```
１時間は掛かるので覚悟して実行する
$ docker build --no-cache -t debian11lxde .
$ docker history debian11lxde

$ docker image ls

ホート開放する場合は、localhost:13389 で接続（リモートデスクトップ）
$ docker create --name testdebian -p 13389:3389 debian11lxde

ポート開放しない場合は、172.17.0.2 で接続（おそらく）
$ docker create --name testdebian debian11lxde

$ docker start testdebian

纏めて実行するには、run
$ docker run -itd --name testdebian debian11lxde

ターミナル接続
$ docker exec -it testdebian bash

イメージにコミット
$ docker stop testdebian
$ docker commit testdebian debian11lxde-1
$ docker images

$ docker rm testdebian
$ docker ps -a
$ docker image rm debian11lxde-1
$ docker images
```

## Docker内の共有ボリュームをマウント

```
$ docker volume create docker-disk
$ docker volume ls
$ docker volume inspect docker-disk

--mount または -v でマウント
$ docker run -itd --name testdebian-1 --mount source=docker-disk,target=/app debian11lxde
$ docker run -itd --name testdebian-2 --mount source=docker-disk,target=/app debian11lxde
$ docker ps
$ docker stop testdebian-1
$ docker stop testdebian-2
$ docker rm testdebian-1
$ docker rm testdebian-2

$ docker volume rm docker-disk
```

## ホスト内の共有ボリュームをマウント

```
-v だと初回はディスクを生成する
$ docker run -itd --name testdebian-1 -v "$(pwd)"/mount:/app debian11lxde
$ docker run -itd --name testdebian-2 --mount type=bind,source="$(pwd)"/mount,target=/app debian11lxde

強制削除
$ docker rm -f testdebian-1
$ docker rm -f testdebian-2
```

## tmpfsをマウント（コンテナ停止で削除される、共有できない）

```
--tmpfs はオプションが指定できない
$ docker run -itd --name testdebian-1 --mount type=tmpfs,destination=/app,tmpfs-size=800000000,tmpfs-mode=1777 debian11lxde
$ docker run -itd --name testdebian-2 --tmpfs /app debian11lxde
$ docker rm -f testdebian-1
$ docker rm -f testdebian-2
```